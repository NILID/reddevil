.card
  .card-body
    .row
      .col
        %h2.text-muted= t 'substrates.title'
      .col-2.text-right
        = link_to new_substrate_path, class: 'btn btn-primary' do
          = fa_icon 'plus'
          = t('shared.add')

  = render 'search_form'

  %table.table.table-substrates.table-striped.table-hover.table-sm
    %thead
      %tr
        %th.text-center
          = sort_link @q, :priority,  Substrate.human_attribute_name(:priority)
          %br/
          = sort_link @q, :status,    Substrate.human_attribute_name(:status)
        %th= sort_link @q, :title,    Substrate.human_attribute_name(:title)
        %th= sort_link @q, :drawing,  Substrate.human_attribute_name(:drawing_short)
        %th= sort_link @q, :detail,   Substrate.human_attribute_name(:detail_short)
        %th= sort_link @q, :amount,   Substrate.human_attribute_name(:amount_short)
        %th= sort_link @q, :contract, Substrate.human_attribute_name(:contract)
        %th
          %p= t('substrates.arrival.title')
          %p
            .font-weight-normal= sort_link @q, :arrival_at, t('substrates.arrival.date')
            .font-weight-normal= sort_link @q, :arrival_from, t('substrates.arrival.who')
        %th
          %p= t('substrates.shipping.title')
          %p
            .font-weight-normal= sort_link @q, :shipping_at, t('substrates.shipping.date')
            .font-weight-normal= sort_link @q, :shipping_to, t('substrates.shipping.who')
        %th= t('activerecord.attributes.substrate.shipping_base_html')
        %th
          .font-weight-normal= sort_link @q, :user, Substrate.human_attribute_name(:user)
          .font-weight-normal= sort_link @q, :created_at, t('substrates.created_at')
        %th

    %tbody
      - @substrates.each do |substrate|
        %tr
          %td.text-center
            = priority_tag substrate.priority
            %br/
            = status_text(substrate.status)
          %td= link_to substrate.title, substrate
          %td= substrate.drawing
          %td= substrate.detail
          %td= substrate.amount
          %td= substrate.contract
          %td
            = short_date substrate.arrival_at if substrate.arrival_at
            .text-muted= substrate.arrival_from
          %td
            = short_date substrate.shipping_at if substrate.shipping_at
            .text-muted= substrate.shipping_to
          %td= substrate.shipping_base
          %td
            = substrate.author
            .text-muted{title: l(substrate.created_at, format: :long), data: { toggle: 'tooltip' }}
              = short_date substrate.created_at
          %td
            .btn-group
              %button.btn.btn-sm.btn-outline-primary.dropdown-toggle{ type: 'button', data: { toggle: 'dropdown' }, aria: { haspopup: 'true', expanded: 'false' } }
                = fa_icon 'cog'
              .dropdown-menu.dropdown-menu-right
                = link_to t('shared.edit'), edit_substrate_path(substrate), class: 'dropdown-item'
                = link_to t('shared.del'), substrate, method: :delete, data: { confirm: t('shared.sure') }, class: 'dropdown-item'
