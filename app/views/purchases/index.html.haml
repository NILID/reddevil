- model_class = Purchase

.row
  .col-md-12
    .well
      .alert.alert-info= t 'shared.building'

      .page-header.clearfix
        %h3.pull-left
          = t 'purchases.title'
          - if can? :manage, @year
            %small
              = link_to t('shared.edit'), edit_year_path(@year), class: 'btn btn-default btn-xs'
              = link_to t('shared.del'), @year, method: :delete, data: { confirm: t('shared.sure') }, class: 'btn btn-xs btn-danger'
        .pull-right
          - User.sellers.each do |u|
            = link_to user_profile_path(u), title: u.profile.surname do
              = image_tag u.profile.avatar(:thumb), width: '30px', class: 'img-circle img-circle-bordered'
      .row
        .col-md-5.col-sm-6.col-lg-4
          = bootstrap_form_for(@q, url: year_purchases_path(@year), method: :get) do |f|
            = f.select :sorts,
              options_for_select({ t('purchases.sort_by.title') => :title, t('purchases.sort_by.user') => :user_id, t('purchases.sort_by.price') => :price, t('purchases.sort_by.doc') => :doc}.collect { |c| c }, params[:q] ? params[:q][:sorts] : []),
              hide_label: true,
              prepend: t('shared.sort_by'),
              append: (f.primary 'OK')

      .purchases-table
        %table.table.table-bordered.table-hover.table-condensed.table-white
          %thead.header
            %tr
              %th â„–
              %th= model_class.human_attribute_name(:title)
              - @year.columns.each do |column|
                %th= column.name
              %th= t 'deliveries.title'

          %tbody= render partial: 'purchase', collection: @purchases
        = link_to new_form_year_purchase_path(@year, Purchase), method: :post, remote: true, disable_with: t('shared.waiting'), class: 'btn btn-primary btn-sm' do
          %i.glyphicon.glyphicon-plus
          &nbsp;
          = t 'purchases.add_new'