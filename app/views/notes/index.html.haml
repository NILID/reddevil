- label_css_classes = { new: 'info', done: 'success', failed: 'important', later: 'warning' }

- content_for :sidebar do
  - label_css_classes.each do |k,v|
    %p
      = link_to notes_path(:'q[status_eq]' => k) do
        %span.label{ class: "label-#{v}" }
          %b= @notes_all_count[k.to_s] || '0'
          = t "notes.#{k}"

- model_class = Note
.page-header
  %h4
    = t 'notes.title'
    = link_to(new_note_path, class: 'btn btn-primary') do
      %i.icon.icon-plus
%table.table.table-striped.table-condensed
  %thead
    %tr
      %th
      %th
      %th= model_class.human_attribute_name(:content)
      %th= model_class.human_attribute_name(:status)
      %th= model_class.human_attribute_name(:created_at)
      - if can? :manage, Note
        %th= t '.actions', default: t('helpers.actions')
  %tbody
    - @notes.each do |note|
      %tr{ class: label_css_classes[note.status.to_sym] }
        %td= link_to note.id, note
        %td
          - if note.screenshot?
            = link_to note.screenshot.url(:medium), class: 'fancybox thumnbail' do
              %i.icon.icon-picture
        %td
          = simple_format truncate(note.content, length: 200, omission: '...')
          - if note.review?
            .well.well-small= simple_format note.review
        %td
          %span.label{class: "label-#{label_css_classes[note.status.to_sym]}"}= t "notes.#{note.status}"
        %td.span2= Russian.strftime(note.created_at, "%d %B")
        - if can? :manage, Note
          %td
            = link_to t('.edit', :default => t("helpers.links.edit")), edit_note_path(note), :class => 'btn btn-mini'
            = link_to t('.destroy', :default => t("helpers.links.destroy")), note_path(note), :method => :delete, :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) }, :class => 'btn btn-mini btn-danger'